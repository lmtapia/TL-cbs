module TL-1 
language TL 
start symbol Start

test TL-1 arit1-assoc [[
3 + 4 / 2 + 5 / 3
]] transform "Generate Funcons" to
"initialise-binding finalise-failing int-add
  (int-add
     (decimal \"3\",
      checked int-div
        (decimal \"4\",
         decimal \"2\")),
   checked int-div
     (decimal \"5\",
      decimal \"3\"))"
test TL-1 arit1 [[
( 34 + 6 ) / 2
]] transform "Generate Funcons" to
"initialise-binding finalise-failing checked int-div
  (int-add
     (decimal \"34\",
      decimal \"6\"),
   decimal \"2\")"
test TL-1 bool1 [[
false or true
]] transform "Generate Funcons" to
"initialise-binding finalise-failing if-else
  (false,
   true,
   true)"
test TL-1 bool2 [[
false or ((5 > 4) and true)
]] transform "Generate Funcons" to
"initialise-binding finalise-failing if-else
  (false,
   true,
   if-else
     (is-greater
        (decimal \"5\",
         decimal \"4\"),
      true,
      false))"
test TL-1 bool-not [[
no false == (7 < 0)
]] transform "Generate Funcons" to
"initialise-binding finalise-failing is-eq
  (not false,
   is-less
     (decimal \"7\",
      decimal \"0\"))"
test TL-1 div0 [[
45 / 0
]] transform "Generate Funcons" to
"initialise-binding finalise-failing checked int-div
  (decimal \"45\",
   decimal \"0\")"
test TL-1 div [[
8 / 3
]] transform "Generate Funcons" to
"initialise-binding finalise-failing checked int-div
  (decimal \"8\",
   decimal \"3\")"
test TL-1 id2 [[
aaa
]] transform "Generate Funcons" to
"initialise-binding finalise-failing assigned bound
  \"aaa\""
test TL-1 id [[
x
]] transform "Generate Funcons" to
"initialise-binding finalise-failing assigned bound
  \"x\""
test TL-1 int0 [[
0
]] transform "Generate Funcons" to
"initialise-binding finalise-failing decimal
  \"0\""
test TL-1 int [[
35
]] transform "Generate Funcons" to
"initialise-binding finalise-failing decimal
  \"35\""
test TL-1 sum [[
34 + 17
]] transform "Generate Funcons" to
"initialise-binding finalise-failing int-add
  (decimal \"34\",
   decimal \"17\")"